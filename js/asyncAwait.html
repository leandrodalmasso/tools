<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Async Await</title>
</head>
<body>
<script>
  /*
  async ensures that the function returns a promise, and wraps non-promises in it
  await makes JavaScript wait until that promise settles and returns its result
  */

  function getPromise(resolves = true) {
    return new Promise((resolve, reject) => {
      if (resolves) {
        setTimeout(() => resolve('done!'), 1000);
      } else {
        setTimeout(() => reject(new Error('oops!')), 1000);
      }
    })
  }

  // async function callGetPromise() {
  //   try {
  //     const response1 = await getPromise();
  //     console.log(response1);
  //     const response2 = await getPromise(false);
  //     console.log(response2);
  //     const response3 = await getPromise();
  //     console.log(response3);
  //   } catch (error) {
  //     console.log(error.message);
  //   }
  // }

  // callGetPromise();

  async function callGetPromise() {
    const response1 = await getPromise();
    console.log(response1);
    const response2 = await getPromise(false);
    console.log(response2);
    const response3 = await getPromise();
    console.log(response3);
  }

  function withCatchErrors(fn) {
    // rest parameters
    return function(...args) {
      // spread operator
      return fn(...args).catch(error => { console.log(error.message) });
    }
  }

  withCatchErrors(callGetPromise)();
</script>
</body>
</html>